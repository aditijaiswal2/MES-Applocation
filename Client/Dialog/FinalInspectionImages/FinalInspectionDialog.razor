@using MES.Client.Pages.Admin
@using MES.Client.Utitlity
@using MES.Shared.Models
@using MES.Shared;
@using Newtonsoft.Json
@using System.Text
@using MES.Shared.DTOs
@using MES.Shared.Entities
@using System.Net
@using System.ComponentModel.DataAnnotations;
 @using MES.Shared.Models.Rotors


 @inject IJSRuntime JSRuntime
@inject ISnackbar Snackbar
@inject HttpClient HttpClient
@inject IDialogCompletionService CompletionService
 @inject IHttpClientFactory _httpClient
@inject NavigationManager Navigation



<div>
    <MudDialog MaxWidth="MaxWidth.ExtraLarge" FullWidth="true">

        <TitleContent>
            <MudText Typo="Typo.h6">
                <MudIcon Icon="@Icons.Material.Filled.AcUnit" Class="mr-3 mb-n1" />
                SERVICE ROTOR FINAL INSPECTION REPORT
            </MudText>
        </TitleContent>
        <DialogContent>

            <MudForm Class="mt-4 p-4 w-100" id="printForm-section">
                <MudCardContent>

                    <MudGrid Class="w-100">

                        <MudGrid Spacing="3">

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Sales Order</MudText>
                                <MudText Typo="Typo.body1">@Grinding.SalesOrderNumber</MudText>
                            </MudItem>

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Customer PO#</MudText>
                                <MudText Typo="Typo.body1">@InspectionData.CustomerPoNum</MudText>
                            </MudItem>

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Customer</MudText>
                                <MudText Typo="Typo.body1">@Grinding.Customer</MudText>
                            </MudItem>

                        </MudGrid>

                        <MudGrid Spacing="3">

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Dwg#</MudText>
                                <MudText Typo="Typo.body1">@InspectionData.DWGNum</MudText>
                            </MudItem>

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">AG#</MudText>
                                <MudText Typo="Typo.body1">@InspectionData.AGNum</MudText>
                            </MudItem>

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Description</MudText>
                                <MudText Typo="Typo.body1">@InspectionData.Description</MudText>
                            </MudItem>

                        </MudGrid>

                        <MudGrid Spacing="3">

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Material</MudText>
                                <MudText Typo="Typo.body1">@Grinding.Materials</MudText>
                            </MudItem>

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Special notes / comments</MudText>
                                <MudText Typo="Typo.body1">@InspectionData.SpecialNoteComment</MudText>
                            </MudItem>

                            <MudItem md="4" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Dressed With New Bearings</MudText>
                                <MudText Typo="Typo.body1">@InspectionData.Dressedwithnewbearing</MudText>
                            </MudItem>

                        </MudGrid>

                    </MudGrid>
                </MudCardContent>
                <!-- Table Section -->
                <MudGrid Spacing="3" Class="mt-4">
                    <MudTable T="RotorsFinalInspection" Items="@tableData" Elevation="1">
                        <HeaderContent>
                            <MudTh>Description</MudTh>
                            <MudTh>Start</MudTh>
                            <MudTh>Finish</MudTh>
                            <MudTh>Date</MudTh>
                            <MudTh>Name</MudTh>
                        </HeaderContent>
                        <RowTemplate>
                            <MudTd DataLabel="Description">@context.Description</MudTd>
                            <MudTd DataLabel="Start">
                                <MudTextField @bind-Value="context.Start" ReadOnly />
                            </MudTd>
                            <MudTd DataLabel="Finish">
                                <MudTextField @bind-Value="context.Finish" ReadOnly />
                            </MudTd>
                            <MudTd DataLabel="Date">
                                <MudTextField @bind-Value="context.Date" ReadOnly />
                            </MudTd>
                            <MudTd DataLabel="Name">
                                <MudTextField @bind-Value="context.Name" ReadOnly />
                            </MudTd>
                        </RowTemplate>
                    </MudTable>

                </MudGrid>

                <MudCardContent>

                    <MudGrid Class="w-100" Style="margin-top:10px;">

                        <MudGrid Spacing="3">
                            <MudItem md="6" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Inspector Signature</MudText>
                                <MudTextField @bind-Value="InspectionData.InspectorSing" Variant="Variant.Text" ReadOnly />
                            </MudItem>

                            <MudItem md="6" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">Comments</MudText>
                                <MudTextField @bind-Value="InspectionData.InspectorComments" Variant="Variant.Text" ReadOnly />
                            </MudItem>

                            <MudItem md="6" xs="12" class="outlined-box pa-2">
                                <MudText Typo="Typo.h6" Color="Color.Primary">OK TO SHIP</MudText>
                                <MudTextField @bind-Value="InspectionData.Oktoship" Variant="Variant.Text" ReadOnly />
                            </MudItem>

                        </MudGrid>
                    </MudGrid>
                </MudCardContent>

                <MudGrid Spacing="3" Justify="Justify.Center" AlignItems="AlignItems.Center">
                    <MudItem xs="12" md="6" Class="text-center">
                        <h5>For New Rotors and Spare Parts</h5>
                        <p Class="text-center">Please Call</p>
                        <h6>1.800.844.2927 or 330.677.2225</h6>
                        <p>8:00 am - 5:00 pm, M-F</p>
                    </MudItem>
                </MudGrid>

            </MudForm>
        </DialogContent>
        <DialogActions>
            <MudButton Class="mr-4 mb-2" Variant="Variant.Filled" Size="Size.Small" Color="Color.Primary" OnClick="Print">Print</MudButton>
            <MudButton Variant="Variant.Filled" Size="Size.Small" Color="Color.Error" OnClick="Cancel">Cancel</MudButton>
        </DialogActions>
    </MudDialog>
</div>

@code {
    [Parameter]
    public RotorsFinalInspection InspectionData { get; set; }
    [Parameter]
    public RotorGrindingData Grinding { get; set; }

    //    ["Grinding"] = serialNumberData,

    [CascadingParameter]
    MudDialogInstance MudDialog { get; set; }

    private List<RotorsFinalInspection> tableData = new();

    //  private RotorsFinalInspection FinalInspectionData;
    private RotorsFinalInspection FinalInspectionData = new RotorsFinalInspection();

    private IEnumerable<AppRole> appRoles = new List<AppRole>();

    private void Cancel()
    {
        MudDialog?.Cancel();
    }

    private async Task Print()
    {
        await JSRuntime.InvokeVoidAsync("printForm");
    }


    protected override async Task OnInitializedAsync()
    {
        tableData = new List<RotorsFinalInspection>
    {
        new RotorsFinalInspection { Description = "Flute Diameter", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Land Width", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "T.I.R", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Taper", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Locknut Threads", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Is the Rotor clean?", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Relief Angle", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Journals O.K.?", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Wedgelock assembly", Start = "", Finish = "", Date = DateTime.Now, Name = "" },
        new RotorsFinalInspection { Description = "Special Part Wash (if Applicable )", Start = "", Finish = "", Date = DateTime.Now, Name = "" }
 };


    }

}
